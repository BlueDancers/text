# mysql与mongodb的使用心得

​	我是去年年底接触mongodb,是一个大数据项目,因为要存储文档模型,所以选择了mongodb,那是我第一次听说这数据库,个人是在写jwt登录的时候使用了这个数据库,总的来说,和mysql还是有区别的,当然下面我说的都是本人的经历,并没有经历海量的数据,所以本文...长期更新吧



## MYSQL - 关系型数据库

mysql也算是万金油数据库,基本适用于绝大部分场景,在接触mysql能感觉到,这个很强大,尤其是多表查询,以及事务方面,还有特别好用的方言,但是接触到mongodb后也明显感觉到,mysql的学习成本相对比价高,sql语句并不容易记忆,多表联合查询命令很负,难度与之强大相匹配

回想一下mysql的表结构

| mysql表结构  |                             |
| ------------ | --------------------------- |
| 表           | tables                      |
| 行           | rows                        |
| 主键         | id 与业务无关的值作为主键。 |
| 主键生成策略 | UUID / 自增                 |

| 数据类型   |                            |
| ---------- | -------------------------- |
| 整形       | INT                        |
| 浮点       | FLOAT  ,DOUBLE             |
| 字符       | VARCHAR, CHAR              |
| 日期/时间  | DATE, DATETIME, TIMESTAMP  |
| null       | 不支持（null与null不相等） |
| 布尔值     | 不支持                     |
| 正则表达式 | 不支持                     |
| 数组       | 不支持                     |
| 文本数组   | BLOB, TEXT                 |

每次使用mysql我都会想到java,总感觉和mysql的特性与java和合得来,当然java对于数据库的之处很到位

在数据类型上面明显可以看到,mysql对一些"花里胡哨"的类型支持的并不是很好,从侧面也反应了一点,mysql不够灵活,但是mysql在查询以及事务上面明显更加优秀

## mongodb - 非关系型数据库

​	从本人的角度我更加钟情mongodb,他总是给我带来一些惊喜,mongodb丰富的数据模型,以及在文档的操作上面相对于mysql要方便很多,比如增加一个字段,不需要改变文档结构,以及最近发布的**mondb4.0**以及开始支持事务,

| mongodb表结构 |                                                   |
| ------------- | ------------------------------------------------- |
| 表            | collections                                       |
| 行            | documents                                         |
| 主键          | _id                                               |
| 主键生成策略  | 24位的字符串(time + machine + pid + inc),自己指定 |

| 数据类型   |                                                  |
| ---------- | ------------------------------------------------ |
| 整形       | NumberInt("3"),NumberLong("3")                   |
| 浮点       | 默认使用64位浮点型数值                           |
| 字符       | utf8 字符串                                      |
| 日期/时间  | new Date(), 自新纪元依赖经过的毫秒数，不存储时区 |
| null       | null                                             |
| 布尔值     | true/false                                       |
| 正则表达式 | 支持                                             |
| 数组       | 支持                                             |
| 文本数组   | 支持                                             |

明显看到mongodb对数据类型的支持度很广~~,不过据我晚上看一些资料,mongodb的短板也很明显

- mongodb为了更快,抛弃了join()
- 无事务,这对于一些敏感操作支持度不高,但这也正是MongoDB可以更快地读的原因，没有事务这些负载的处理。MongoDB 可以轻松处理TB级别的数据。 
- 对磁盘的消耗很严重,这与它的编码方式有关，因为MongoDB会通过预分配 大文件空间来避免磁盘碎片问题。 在创建数据库时，系统会创建 一个名为[db_name].0的文件，当该文件有一半以上被使用时，系统会再次创建一个名 为[db_namel].1的文件，该文件的大小是方才的两倍。这个情况会持续不断的发生，因此 256、512、1024、2048大小的文件会被写到磁盘上

不过随着mongodb的不断进步,似乎短板越来越小了

## 小总结

(1) 相比较MySQL，MongoDB数据库更适合那些读作业较重的任务模型。MongoDB能充分利用机器的内存资源。如果机器的内存资源丰富的话，MongoDB的查询效率会快很多。

(2) 相比MongoDB，MySQL数据库更适合插入、更新为主的任务模型，其效率相比于MongoDB优势非常明显。

(3) 在带”_id”插入数据的时候，MongoDB的插入效率其实并不高。如果想充分利用MongoDB性能的话，推荐采取不带”_id”的插入方式，然后对相关字段作索引来查询。

(4) MongoDB适合那些对数据库具体数据格式不明确或者数据库数据格式经常变化的需求模型，而且对开发者十分友好。

(5) 稳定性方面，MongoDB不如MySQL，MySQL不愧是一种非常稳定的数据库，无论在指定主键还是在不指定主键插入的情况下，其效率都差不了太多, 其稳定性还是毋庸置疑。

(6) 事务支持方面，MySQL占绝对优势，MongoDB对事务关系支持薄弱，这也是所有NoSQL数据库共同的缺陷，不过NoSQL并不是为了事务关系而设计的，具体应用还是很需求。



对于数据库的选取,结合项目本身选择,在稳定,以及事务上面还无疑问使用mysql,在性能给力的情况下,涉及到大量的读取就使用mongodb吧,假如是小项目,不会mysql使用mysql,会mysql使用mongodb,就可以感觉到使用上面的差异了